import{l as C,c as w,d as q}from"./session-storage-Om7Yksbp.js";const k=()=>document.querySelector("#lead-time"),U=()=>document.querySelector("#time"),E=(t,o,e)=>{var n;const s=t.filter(i=>i.time===o);if(s.length===0)return;const a=k();a&&(a.textContent=((n=s[0].leadTime)==null?void 0:n.toFixed(2))??Number.NaN);const c=U();c&&(c.textContent=`${s[0].time.toString()}/${e}`)},b=(t,o)=>{const e=document.createElement("div");e.id=`thread${t}`,e.className="thread";const s=document.createElement("div");s.id=`thread-title-${t}`,s.textContent=o;const a=document.createElement("div");a.id=`thread-user-story-${t}`;const c=document.createElement("div");return c.id=`thread-state-${t}`,c.textContent="Wait",e.append(s,a,c),e},x=(t,o)=>{o.filter(e=>e.action==="CreateThread").forEach(e=>{const s=b(e.id,e.name);t.append(s)})},A=(t,o)=>{const e=document.createElement("div");return e.id=`user-story-${t}`,e.className="userStory",e.textContent=o,e},v=(t,o)=>{o.filter(({action:e})=>e==="CreateUserStory").filter(({id:e})=>e!==-1).map(({id:e,name:s})=>A(e,s)).forEach(e=>{t.appendChild(e)})},L=()=>document.querySelector("#threads"),R=t=>document.querySelector(`#thread-state-${t}`),h=t=>document.querySelector(`#thread-user-story-${t}`),p=()=>document.querySelector("#backlog"),D=()=>document.querySelector("#done"),I=t=>document.querySelector(`[id^="user-story-${t}"]`),g=t=>Array.from(document.querySelectorAll(`[id^="user-story-${t}"]`)),H=(t,o)=>document.querySelector(`#user-story-${t}-${o}`),N=()=>document.querySelector("#compute"),P=()=>document.querySelector("#compute-all"),f=(t,o)=>{const e=R(t);e&&(e.textContent=o)},$=async(t,o,e)=>{var a,c,n,i,u,y;const s=t.filter(r=>r.time===o);for(const r of s){if(r.userStoryId===-1){Array.from(((a=h(r.threadId))==null?void 0:a.children)??[]).forEach(d=>d.remove()),f(r.threadId,"Wait");continue}switch(r.state){case"InProgress":{const d=I(r.userStoryId);d&&((c=h(r.threadId))==null||c.appendChild(d),d.id=`user-story-${r.userStoryId}-${r.threadId}`),f(r.threadId,"Develop");break}case"Review":{if(H(r.userStoryId,r.threadId))continue;const d=(n=I(r.userStoryId))==null?void 0:n.cloneNode(!0),l=`user-story-${r.userStoryId}-${r.threadId}`;if(d){d.id=l;const m=h(r.threadId);m==null||m.appendChild(d)}(i=document.querySelector(`#backlog #user-story-${r.userStoryId}`))==null||i.remove(),f(r.threadId,"Review");break}case"ToReview":{const d=g(r.userStoryId),l=d.shift();l&&((u=p())==null||u.appendChild(l),l.id=`user-story-${r.userStoryId}`),d.forEach(m=>m.remove());break}case"Done":{const d=g(r.userStoryId),l=d.shift();l&&((y=D())==null||y.appendChild(l),l.id=`user-story-${r.userStoryId}`),d.forEach(m=>m.remove());break}}await W(e)}},W=t=>new Promise(o=>setTimeout(o,t)),T=(t,o)=>{const e=p();if(e){const s=t.filter(({time:a})=>a===o);v(e,s)}},F=(t,o,e)=>{const s=L();s&&x(s,e);const a=p();if(a){const y=e.filter(({time:r})=>r===1);v(a,y)}const c=Math.max(...t.map(y=>y.time));let n=0;const i=N();i==null||i.addEventListener("click",async()=>{i.disabled=!0,n++,await $(t,n,1e3),E(o,n,c),T(e,n+1),c!==n&&(i.disabled=!1)});const u=P();u==null||u.addEventListener("click",async()=>{for(;c!==n;)n++,await $(t,n,300),E(o,n,c),T(e,n+1);u.disabled=!0})},M=new URLSearchParams(window.location.search),S=M.get("id");S&&F(q(S),w(S),C(S));
